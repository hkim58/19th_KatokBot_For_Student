# 🗓️ Google Calendar 메신저봇 완전 설치 가이드

**대상**: 메신저봇 프로젝트 학생들  
**목표**: Google Calendar와 연동되는 카카오톡 봇 완전 구축  
**소요시간**: 약 30분

---

## 📋 **완성 후 기능**

### ✅ **메신저봇에서 가능한 명령어**
```
📅 일정 조회:
• "일정" 또는 "오늘 일정" - 오늘 일정 보기
• "내일 일정" - 내일 일정 보기
• "이번주 일정" - 주간 일정 보기

➕ 일정 추가:
• "일정 추가 회의 내일 3시"
• "일정 추가 점심 오늘 12시 친구와"

🗑️ 일정 삭제:
• "일정 삭제 1" (일정 번호로 삭제)

🕐 빈시간 확인:
• "빈시간 오늘"
• "빈시간 내일"

❓ 도움말:
• "캘린더 도움말" - 전체 사용법
• "서버 상태" - 연결 상태 확인
```

---

## 🚀 **1단계: Google Cloud 설정 (5분)**

### 1-1. Google Cloud Console 접속
1. https://console.cloud.google.com 접속
2. 새 프로젝트 생성 또는 기존 프로젝트 선택

### 1-2. Calendar API 활성화
```bash
1. 좌측 메뉴 > "API 및 서비스" > "라이브러리"
2. "Google Calendar API" 검색
3. "사용" 버튼 클릭
```

### 1-3. OAuth 2.0 클라이언트 ID 생성
```bash
1. "API 및 서비스" > "사용자 인증 정보"
2. "사용자 인증 정보 만들기" > "OAuth 클라이언트 ID"
3. 애플리케이션 유형: "데스크톱 앱"
4. 이름: "Calendar MessengerBot"
5. "만들기" 버튼 클릭
6. JSON 다운로드 → credentials.json으로 저장
```

---

## 💻 **2단계: FastAPI 서버 설치 (10분)**

### 2-1. 서버 파일 준비
```bash
# 프로젝트 폴더 생성
mkdir google-calendar-bot
cd google-calendar-bot

# 필요한 파일들 복사 (이 예제 폴더에서)
# - fastapi_server.py
# - requirements.txt
# - credentials.json (다운로드한 파일)
```

### 2-2. Python 가상환경 설정
```bash
# 가상환경 생성
python3 -m venv venv

# 가상환경 활성화
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# 패키지 설치
pip install -r requirements.txt
```

### 2-3. 첫 실행 및 OAuth 인증
```bash
# 서버 실행
python fastapi_server.py

# 자동으로 브라우저가 열림 → Google 로그인
# 캘린더 권한 승인
# token.pickle 파일 자동 생성 확인
```

### ✅ **2단계 검증**
```bash
# 브라우저에서 확인:
http://localhost:9000/docs        # API 문서
http://localhost:9000/api/health  # 서버 상태
```

---

## 🤖 **3단계: 메신저봇 설정 (5분)**

### 3-1. 메신저봇 코드 수정
```javascript
// GoogleCalendarBot.js 파일에서 수정할 부분:

var CONFIG = {
    // 🎯 [필수] 서버 URL 변경
    SERVER_URL: "http://localhost:9000",  // 로컬 테스트용
    // 또는 "http://your-server-ip:9000"  // 실제 서버용
    
    // 🎯 [필수] 봇이 작동할 카톡방 이름
    TARGET_ROOMS: ["테스트방"],  // 실제 방 이름으로 변경
    
    // 기타 설정은 그대로 유지
};
```

### 3-2. 메신저봇 앱에서 실행
```bash
1. 메신저봇 R 앱 실행
2. GoogleCalendarBot.js 파일 열기
3. 컴파일 (스크립트 검사)
4. 실행
5. 로그 탭에서 오류 확인
```

---

## 🧪 **4단계: 연동 테스트 (5분)**

### 4-1. 기본 기능 테스트
```bash
카톡방에서 차례대로 입력:

1. "서버 상태" → ✅ 서버 연결 확인
2. "일정" → 📅 오늘 일정 표시 (없으면 "일정이 없습니다")
3. "일정 추가 테스트 내일 3시" → ➕ 일정 등록 성공 메시지
4. "내일 일정" → 📅 방금 추가한 테스트 일정 표시
5. "일정 삭제 1" → 🗑️ 일정 삭제 성공 메시지
```

### 4-2. 고급 기능 테스트
```bash
1. "빈시간 오늘" → 🕐 오늘의 빈 시간 표시
2. "일정 추가 회의 오늘 2시 중요한 회의" → ➕ 설명 포함 일정 추가
3. "캘린더 도움말" → ❓ 전체 사용법 표시
```

### ✅ **테스트 성공 기준**
- [ ] 서버 상태 확인 성공
- [ ] 일정 조회 응답 받음
- [ ] 일정 추가 성공
- [ ] 일정 삭제 성공
- [ ] Google Calendar 웹/앱에서도 일정 확인됨

---

## 🌐 **5단계: 서버 배포 (선택사항)**

### 5-1. 로컬 개발 vs 서버 배포

#### 🏠 **로컬 개발 (추천 - 시작용)**
```bash
# 장점:
- 설정 간단
- 디버깅 쉬움
- 무료

# 단점:
- 컴퓨터 켜져있을 때만 작동
- 외부에서 접근 불가

# 사용법:
SERVER_URL: "http://localhost:9000"
```

#### 🌍 **서버 배포 (고급 사용자)**
```bash
# 디지털 오션 서버에 배포:
1. 서버 생성
2. 파일 업로드
3. 포트 9000 열기
4. nohup python fastapi_server.py &

# 메신저봇에서:
SERVER_URL: "http://your-server-ip:9000"
```

---

## 🛠️ **6단계: 커스터마이징**

### 6-1. 메신저봇 명령어 수정
```javascript
// GoogleCalendarBot.js에서 원하는 명령어로 변경:

// 기존:
if (content === "일정" || content === "일정 보여줘")

// 수정 예시:
if (content === "오늘뭐해" || content === "스케줄")
```

### 6-2. 시간 파싱 개선
```javascript
// parseTime 함수에서 더 많은 형식 지원:
// "오후 3시 30분", "15:30", "3시반" 등
```

### 6-3. 캘린더 기능 확장
```python
# fastapi_server.py에서 추가 가능한 기능:
- 반복 일정 등록
- 알림 설정
- 다른 캘린더 연동
- 참석자 초대
```

---

## 🆘 **문제 해결**

### ❌ **자주 발생하는 문제들**

#### 1. "credentials.json 파일이 없습니다"
```bash
해결: Google Cloud Console에서 OAuth 클라이언트 ID 다시 다운로드
위치: API 및 서비스 > 사용자 인증 정보
```

#### 2. "서버 연결 실패"
```bash
확인 사항:
1. FastAPI 서버가 실행 중인지 확인
2. 포트 9000이 사용 가능한지 확인
3. 방화벽 설정 확인
4. SERVER_URL 주소 정확한지 확인
```

#### 3. "OAuth 권한 에러"
```bash
해결:
1. token.pickle 파일 삭제
2. 서버 재시작으로 재인증
3. Google 계정 권한 확인
```

#### 4. "메신저봇 컴파일 에러"
```bash
확인 사항:
1. ES5 문법 사용 (const → var)
2. 중괄호 닫기 확인
3. Log 탭에서 상세 에러 확인
```

#### 5. "일정이 보이지 않음"
```bash
확인:
1. Google Calendar 웹에서 직접 확인
2. 시간대 설정 (Asia/Seoul)
3. 캘린더 권한 범위 확인
```

### 📞 **도움 요청 방법**
```bash
문제 발생 시 다음 정보와 함께 질문:
1. 에러 메시지 전체 복사
2. 어느 단계에서 발생했는지
3. 운영체제 (Windows/Mac/Linux)
4. Python 버전 (python --version)
```

---

## 🎉 **완료 확인**

### ✅ **성공적으로 완료되었다면:**
- [x] Google Calendar에 일정 자동 등록됨
- [x] 카톡에서 일정 조회 가능
- [x] 일정 추가/삭제 가능
- [x] 빈시간 확인 가능
- [x] 도움말 및 상태 확인 가능

### 🚀 **다음 단계:**
1. **친구들과 공유**: 같은 방법으로 친구들도 설정
2. **기능 확장**: 알림, 반복 일정 등 추가
3. **다른 서비스 연동**: Gmail, 슬랙 등과 연결
4. **AI 어시스턴트**: Claude, ChatGPT와 연동

---

**🎊 축하합니다! Google Calendar 메신저봇이 완성되었습니다!**

이제 카카오톡에서 자연스럽게 일정을 관리할 수 있습니다. 질문이나 문제가 있으면 언제든 도움을 요청하세요! 📱✨