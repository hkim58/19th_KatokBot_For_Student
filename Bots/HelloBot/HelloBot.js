/**
 * ====================================
 * HelloBot.js - 인사 봇 (초보자용 상세 주석 버전)
 * ====================================
 * 
 * 이 봇은 다양한 인사말을 받으면 시간대에 맞는 인사로 답장합니다.
 * 
 * 예시:
 *   오전 10시 - 사용자: "안녕"
 *            - 봇: "철수님, 좋은 아침이에요!"
 *   
 *   오후 3시 - 사용자: "하이"
 *           - 봇: "영희님, 좋은 오후에요!"
 */

// ====== 1단계: 봇 객체 가져오기 ======
// 메신저봇에서 제공하는 BotManager를 통해 현재 봇을 제어할 준비를 합니다
var bot = BotManager.getCurrentBot();

// ====== 2단계: 메시지 이벤트 리스너 등록 ======
// 카톡 메시지가 오면 자동으로 이 함수가 실행됩니다
bot.on("message", function(msg) {
    
    // ====== 3단계: 인사말 감지하기 ======
    // || (OR 연산자)의 의미:
    // - "또는"을 뜻합니다
    // - 여러 조건 중 하나라도 참(true)이면 전체가 참이 됩니다
    // 
    // == (동등 연산자)의 의미:
    // - 두 값이 완전히 같은지 비교합니다
    // - "안녕" == "안녕" → true (참)
    // - "안녕" == "안녕하세요" → false (거짓)
    //
    // 이 조건문이 확인하는 것:
    // 메시지가 정확히 다음 5개 중 하나와 일치하는지 체크합니다:
    // 1. "안녕"
    // 2. "하이"  
    // 3. "안녕하세요"
    // 4. "굿모닝"
    // 5. "반갑습니다"
    //
    // ⚠️ 초보자가 자주 실수하는 경우들:
    // - 대소문자 구분: "Hello" ≠ "hello", "HI" ≠ "hi"
    // - 띄어쓰기 구분: "안녕 " ≠ "안녕" (뒤에 공백 있음)
    // - 특수문자 구분: "안녕!" ≠ "안녕", "안녕~" ≠ "안녕"
    // - 이모지 구분: "안녕😊" ≠ "안녕", "👋" ≠ "안녕"
    //
    // 💡 팁: 공백 문제 해결하기
    // 사용자가 실수로 공백을 넣어도 인식하게 하려면:
    // if (msg.content.trim() == "안녕") { ... }
    // trim()은 앞뒤 공백을 제거합니다 (" 안녕 " → "안녕")
    if (msg.content == "안녕" || msg.content == "하이" || msg.content == "안녕하세요" || msg.content == "굿모닝" || msg.content == "반갑습니다") {
        
        // ====== 4단계: 현재 시간 확인하기 ======
        // new Date(): 현재 날짜와 시간 정보를 담은 객체를 생성합니다
        // .getHours(): 시간만 추출합니다 (0~23 사이의 숫자)
        // 
        // 시간 예시:
        // - 오전 9시 → 9
        // - 오후 2시 → 14 (24시간 형식)
        // - 오후 11시 → 23
        // - 자정 → 0
        //
        // 📍 중요: 디바이스 시간 기준
        // - 봇이 실행되는 기기의 시간을 따릅니다
        // - 폰 설정이 해외 시간이면 그 시간대로 인사합니다
        // - 한국 시간 기준으로 고정하려면 별도 처리 필요
        var hour = new Date().getHours();
        
        // ====== 5단계: 인사말 준비하기 ======
        // greeting 변수를 만들고 빈 문자열("")로 초기화합니다
        // 이 변수에 시간대별 인사말을 저장할 예정입니다
        var greeting = "";
        
        // ====== 6단계: 시간대별 인사말 선택하기 ======
        // if-else if-else 구조:
        // - 순서대로 조건을 확인합니다
        // - 참인 조건을 만나면 해당 코드를 실행하고 끝납니다
        // - 모든 조건이 거짓이면 else 부분을 실행합니다
        
        // 조건 1: 오전 (0시~11시)
        // hour < 12 의미: hour가 12보다 작은가?
        // 0, 1, 2, ... 11 → true (오전)
        if (hour < 12) {
            greeting = "좋은 아침이에요!";
        }
        // 조건 2: 오후 (12시~17시)
        // hour < 18 의미: hour가 18보다 작은가?
        // 12, 13, 14, ... 17 → true (오후)
        // (이미 12 이상인 것은 위 조건에서 확인했음)
        else if (hour < 18) {
            greeting = "좋은 오후에요!";
        }
        // 조건 3: 저녁 (18시~23시)
        // 위 조건들이 모두 거짓이면 (18시 이상이면)
        else {
            greeting = "좋은 저녁이에요!";
        }
        
        // ====== 7단계: 답장 보내기 ======
        // msg.author.name: 메시지를 보낸 사람의 이름
        // + 연산자: 문자열을 이어붙입니다
        // 
        // 문자열 결합 예시:
        // msg.author.name = "철수"
        // greeting = "좋은 아침이에요!"
        // 결과: "철수님, 좋은 아침이에요!"
        msg.reply(msg.author.name + "님, " + greeting);
    }
    
    // 인사말이 아닌 경우:
    // - if 조건이 거짓이면 아무것도 하지 않습니다
    // - 봇은 다음 메시지를 기다립니다
});

/**
 * ====== 메신저봇 동작 흐름 정리 ======
 * 
 * 1. 사용자가 카톡 메시지를 보냅니다
 * 2. 봇이 메시지 내용을 확인합니다
 * 3. 5가지 인사말 중 하나인지 체크합니다
 * 4. 인사말이면 현재 시간을 확인합니다
 * 5. 시간대에 맞는 인사말을 선택합니다
 * 6. 사용자 이름과 인사말을 합쳐서 답장합니다
 * 
 * ====== 주요 개념 정리 ======
 * 
 * - var: 변수 선언 (값을 저장하는 상자 만들기)
 * - ||: OR 연산자 (여러 조건 중 하나라도 참이면 OK)
 * - ==: 동등 비교 (두 값이 같은지 확인)
 * - new Date(): 현재 날짜/시간 객체 생성
 * - getHours(): 시간만 가져오기 (0~23)
 * - if-else if-else: 조건에 따라 다른 코드 실행
 * - +: 문자열 연결 (텍스트 이어붙이기)
 * 
 * ====== 실습 과제 ======
 * 
 * [초급]
 * 1. 인사말을 추가해보세요 (예: "헬로", "방가방가")
 * 2. 시간대별 인사말을 바꿔보세요
 * 3. 이름 뒤에 "님" 대신 다른 호칭 사용하기
 * 
 * [중급]
 * 4. 새벽 시간대(0~5시)를 추가로 구분하기
 *    힌트: if (hour < 6) greeting = "새벽인데 안 주무세요?";
 * 5. 주말과 평일 구분하여 다른 인사하기
 *    힌트: new Date().getDay() // 0=일요일, 6=토요일
 * 
 * [고급]
 * 6. 인사말 배열을 만들어 더 깔끔하게 관리하기
 *    var greetings = ["안녕", "하이", ...];
 *    if (greetings.indexOf(msg.content) != -1) { ... }
 * 7. 랜덤 인사말 답장하기
 *    var responses = ["반가워요!", "어서오세요!", ...];
 *    var random = Math.floor(Math.random() * responses.length);
 * 8. trim()으로 공백 문제 해결하기
 *    var cleanMessage = msg.content.trim();  // 앞뒤 공백 제거
 *    if (cleanMessage == "안녕") { ... }
 * 
 * ====== 개선된 코드 예시 (고급) ======
 * 
 * // 인사말 목록을 배열로 관리
 * var greetings = ["안녕", "하이", "안녕하세요", "굿모닝", "반갑습니다"];
 * 
 * // 공백 제거 후 확인 (더 유연한 인식)
 * var cleanMessage = msg.content.trim();
 * 
 * // 배열에 포함되어 있는지 확인
 * if (greetings.indexOf(cleanMessage) != -1) {
 *     var hour = new Date().getHours();
 *     var timeGreetings = {
 *         morning: ["좋은 아침!", "굿모닝!", "상쾌한 아침이네요!"],
 *         afternoon: ["좋은 오후!", "점심 맛있게 드셨나요?"],
 *         evening: ["좋은 저녁!", "오늘 하루 어떠셨나요?"]
 *     };
 *     
 *     // 시간대별 랜덤 인사 선택
 *     var greetingList;
 *     if (hour < 12) greetingList = timeGreetings.morning;
 *     else if (hour < 18) greetingList = timeGreetings.afternoon;
 *     else greetingList = timeGreetings.evening;
 *     
 *     var randomIndex = Math.floor(Math.random() * greetingList.length);
 *     msg.reply(msg.author.name + "님, " + greetingList[randomIndex]);
 * }
 */